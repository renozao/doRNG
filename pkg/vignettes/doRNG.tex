% 
\documentclass[a4paper,12pt]{article}\usepackage{graphicx, color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\definecolor{fgcolor}{rgb}{0.267, 0.267, 0.267}
\newcommand{\hlnumber}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlfunctioncall}[1]{\textcolor[rgb]{0.501960784313725,0,0.329411764705882}{\textbf{#1}}}%
\newcommand{\hlstring}[1]{\textcolor[rgb]{0.6,0.6,1}{#1}}%
\newcommand{\hlkeyword}[1]{\textcolor[rgb]{0,0,0}{\textbf{#1}}}%
\newcommand{\hlargument}[1]{\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%
\newcommand{\hlcomment}[1]{\textcolor[rgb]{0.180392156862745,0.6,0.341176470588235}{#1}}%
\newcommand{\hlroxygencomment}[1]{\textcolor[rgb]{0.43921568627451,0.47843137254902,0.701960784313725}{#1}}%
\newcommand{\hlformalargs}[1]{\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%
\newcommand{\hleqformalargs}[1]{\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%
\newcommand{\hlassignement}[1]{\textcolor[rgb]{0,0,0}{\textbf{#1}}}%
\newcommand{\hlpackage}[1]{\textcolor[rgb]{0.588235294117647,0.709803921568627,0.145098039215686}{#1}}%
\newcommand{\hlslot}[1]{\textit{#1}}%
\newcommand{\hlsymbol}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlprompt}[1]{\textcolor[rgb]{0.266666666666667,0.266666666666667,0.266666666666667}{#1}}%

\usepackage{color}%
 
\newsavebox{\hlnormalsizeboxclosebrace}%
\newsavebox{\hlnormalsizeboxopenbrace}%
\newsavebox{\hlnormalsizeboxbackslash}%
\newsavebox{\hlnormalsizeboxlessthan}%
\newsavebox{\hlnormalsizeboxgreaterthan}%
\newsavebox{\hlnormalsizeboxdollar}%
\newsavebox{\hlnormalsizeboxunderscore}%
\newsavebox{\hlnormalsizeboxand}%
\newsavebox{\hlnormalsizeboxhash}%
\newsavebox{\hlnormalsizeboxat}%
\newsavebox{\hlnormalsizeboxpercent}% 
\newsavebox{\hlnormalsizeboxhat}%
\newsavebox{\hlnormalsizeboxsinglequote}%
\newsavebox{\hlnormalsizeboxbacktick}%

\setbox\hlnormalsizeboxopenbrace=\hbox{\begin{normalsize}\verb.{.\end{normalsize}}%
\setbox\hlnormalsizeboxclosebrace=\hbox{\begin{normalsize}\verb.}.\end{normalsize}}%
\setbox\hlnormalsizeboxlessthan=\hbox{\begin{normalsize}\verb.<.\end{normalsize}}%
\setbox\hlnormalsizeboxdollar=\hbox{\begin{normalsize}\verb.$.\end{normalsize}}%
\setbox\hlnormalsizeboxunderscore=\hbox{\begin{normalsize}\verb._.\end{normalsize}}%
\setbox\hlnormalsizeboxand=\hbox{\begin{normalsize}\verb.&.\end{normalsize}}%
\setbox\hlnormalsizeboxhash=\hbox{\begin{normalsize}\verb.#.\end{normalsize}}%
\setbox\hlnormalsizeboxat=\hbox{\begin{normalsize}\verb.@.\end{normalsize}}%
\setbox\hlnormalsizeboxbackslash=\hbox{\begin{normalsize}\verb.\.\end{normalsize}}%
\setbox\hlnormalsizeboxgreaterthan=\hbox{\begin{normalsize}\verb.>.\end{normalsize}}%
\setbox\hlnormalsizeboxpercent=\hbox{\begin{normalsize}\verb.%.\end{normalsize}}%
\setbox\hlnormalsizeboxhat=\hbox{\begin{normalsize}\verb.^.\end{normalsize}}%
\setbox\hlnormalsizeboxsinglequote=\hbox{\begin{normalsize}\verb.'.\end{normalsize}}%
\setbox\hlnormalsizeboxbacktick=\hbox{\begin{normalsize}\verb.`.\end{normalsize}}%
\setbox\hlnormalsizeboxhat=\hbox{\begin{normalsize}\verb.^.\end{normalsize}}%



\newsavebox{\hltinyboxclosebrace}%
\newsavebox{\hltinyboxopenbrace}%
\newsavebox{\hltinyboxbackslash}%
\newsavebox{\hltinyboxlessthan}%
\newsavebox{\hltinyboxgreaterthan}%
\newsavebox{\hltinyboxdollar}%
\newsavebox{\hltinyboxunderscore}%
\newsavebox{\hltinyboxand}%
\newsavebox{\hltinyboxhash}%
\newsavebox{\hltinyboxat}%
\newsavebox{\hltinyboxpercent}% 
\newsavebox{\hltinyboxhat}%
\newsavebox{\hltinyboxsinglequote}%
\newsavebox{\hltinyboxbacktick}%

\setbox\hltinyboxopenbrace=\hbox{\begin{tiny}\verb.{.\end{tiny}}%
\setbox\hltinyboxclosebrace=\hbox{\begin{tiny}\verb.}.\end{tiny}}%
\setbox\hltinyboxlessthan=\hbox{\begin{tiny}\verb.<.\end{tiny}}%
\setbox\hltinyboxdollar=\hbox{\begin{tiny}\verb.$.\end{tiny}}%
\setbox\hltinyboxunderscore=\hbox{\begin{tiny}\verb._.\end{tiny}}%
\setbox\hltinyboxand=\hbox{\begin{tiny}\verb.&.\end{tiny}}%
\setbox\hltinyboxhash=\hbox{\begin{tiny}\verb.#.\end{tiny}}%
\setbox\hltinyboxat=\hbox{\begin{tiny}\verb.@.\end{tiny}}%
\setbox\hltinyboxbackslash=\hbox{\begin{tiny}\verb.\.\end{tiny}}%
\setbox\hltinyboxgreaterthan=\hbox{\begin{tiny}\verb.>.\end{tiny}}%
\setbox\hltinyboxpercent=\hbox{\begin{tiny}\verb.%.\end{tiny}}%
\setbox\hltinyboxhat=\hbox{\begin{tiny}\verb.^.\end{tiny}}%
\setbox\hltinyboxsinglequote=\hbox{\begin{tiny}\verb.'.\end{tiny}}%
\setbox\hltinyboxbacktick=\hbox{\begin{tiny}\verb.`.\end{tiny}}%
\setbox\hltinyboxhat=\hbox{\begin{tiny}\verb.^.\end{tiny}}%



\newsavebox{\hlscriptsizeboxclosebrace}%
\newsavebox{\hlscriptsizeboxopenbrace}%
\newsavebox{\hlscriptsizeboxbackslash}%
\newsavebox{\hlscriptsizeboxlessthan}%
\newsavebox{\hlscriptsizeboxgreaterthan}%
\newsavebox{\hlscriptsizeboxdollar}%
\newsavebox{\hlscriptsizeboxunderscore}%
\newsavebox{\hlscriptsizeboxand}%
\newsavebox{\hlscriptsizeboxhash}%
\newsavebox{\hlscriptsizeboxat}%
\newsavebox{\hlscriptsizeboxpercent}% 
\newsavebox{\hlscriptsizeboxhat}%
\newsavebox{\hlscriptsizeboxsinglequote}%
\newsavebox{\hlscriptsizeboxbacktick}%

\setbox\hlscriptsizeboxopenbrace=\hbox{\begin{scriptsize}\verb.{.\end{scriptsize}}%
\setbox\hlscriptsizeboxclosebrace=\hbox{\begin{scriptsize}\verb.}.\end{scriptsize}}%
\setbox\hlscriptsizeboxlessthan=\hbox{\begin{scriptsize}\verb.<.\end{scriptsize}}%
\setbox\hlscriptsizeboxdollar=\hbox{\begin{scriptsize}\verb.$.\end{scriptsize}}%
\setbox\hlscriptsizeboxunderscore=\hbox{\begin{scriptsize}\verb._.\end{scriptsize}}%
\setbox\hlscriptsizeboxand=\hbox{\begin{scriptsize}\verb.&.\end{scriptsize}}%
\setbox\hlscriptsizeboxhash=\hbox{\begin{scriptsize}\verb.#.\end{scriptsize}}%
\setbox\hlscriptsizeboxat=\hbox{\begin{scriptsize}\verb.@.\end{scriptsize}}%
\setbox\hlscriptsizeboxbackslash=\hbox{\begin{scriptsize}\verb.\.\end{scriptsize}}%
\setbox\hlscriptsizeboxgreaterthan=\hbox{\begin{scriptsize}\verb.>.\end{scriptsize}}%
\setbox\hlscriptsizeboxpercent=\hbox{\begin{scriptsize}\verb.%.\end{scriptsize}}%
\setbox\hlscriptsizeboxhat=\hbox{\begin{scriptsize}\verb.^.\end{scriptsize}}%
\setbox\hlscriptsizeboxsinglequote=\hbox{\begin{scriptsize}\verb.'.\end{scriptsize}}%
\setbox\hlscriptsizeboxbacktick=\hbox{\begin{scriptsize}\verb.`.\end{scriptsize}}%
\setbox\hlscriptsizeboxhat=\hbox{\begin{scriptsize}\verb.^.\end{scriptsize}}%



\newsavebox{\hlfootnotesizeboxclosebrace}%
\newsavebox{\hlfootnotesizeboxopenbrace}%
\newsavebox{\hlfootnotesizeboxbackslash}%
\newsavebox{\hlfootnotesizeboxlessthan}%
\newsavebox{\hlfootnotesizeboxgreaterthan}%
\newsavebox{\hlfootnotesizeboxdollar}%
\newsavebox{\hlfootnotesizeboxunderscore}%
\newsavebox{\hlfootnotesizeboxand}%
\newsavebox{\hlfootnotesizeboxhash}%
\newsavebox{\hlfootnotesizeboxat}%
\newsavebox{\hlfootnotesizeboxpercent}% 
\newsavebox{\hlfootnotesizeboxhat}%
\newsavebox{\hlfootnotesizeboxsinglequote}%
\newsavebox{\hlfootnotesizeboxbacktick}%

\setbox\hlfootnotesizeboxopenbrace=\hbox{\begin{footnotesize}\verb.{.\end{footnotesize}}%
\setbox\hlfootnotesizeboxclosebrace=\hbox{\begin{footnotesize}\verb.}.\end{footnotesize}}%
\setbox\hlfootnotesizeboxlessthan=\hbox{\begin{footnotesize}\verb.<.\end{footnotesize}}%
\setbox\hlfootnotesizeboxdollar=\hbox{\begin{footnotesize}\verb.$.\end{footnotesize}}%
\setbox\hlfootnotesizeboxunderscore=\hbox{\begin{footnotesize}\verb._.\end{footnotesize}}%
\setbox\hlfootnotesizeboxand=\hbox{\begin{footnotesize}\verb.&.\end{footnotesize}}%
\setbox\hlfootnotesizeboxhash=\hbox{\begin{footnotesize}\verb.#.\end{footnotesize}}%
\setbox\hlfootnotesizeboxat=\hbox{\begin{footnotesize}\verb.@.\end{footnotesize}}%
\setbox\hlfootnotesizeboxbackslash=\hbox{\begin{footnotesize}\verb.\.\end{footnotesize}}%
\setbox\hlfootnotesizeboxgreaterthan=\hbox{\begin{footnotesize}\verb.>.\end{footnotesize}}%
\setbox\hlfootnotesizeboxpercent=\hbox{\begin{footnotesize}\verb.%.\end{footnotesize}}%
\setbox\hlfootnotesizeboxhat=\hbox{\begin{footnotesize}\verb.^.\end{footnotesize}}%
\setbox\hlfootnotesizeboxsinglequote=\hbox{\begin{footnotesize}\verb.'.\end{footnotesize}}%
\setbox\hlfootnotesizeboxbacktick=\hbox{\begin{footnotesize}\verb.`.\end{footnotesize}}%
\setbox\hlfootnotesizeboxhat=\hbox{\begin{footnotesize}\verb.^.\end{footnotesize}}%



\newsavebox{\hlsmallboxclosebrace}%
\newsavebox{\hlsmallboxopenbrace}%
\newsavebox{\hlsmallboxbackslash}%
\newsavebox{\hlsmallboxlessthan}%
\newsavebox{\hlsmallboxgreaterthan}%
\newsavebox{\hlsmallboxdollar}%
\newsavebox{\hlsmallboxunderscore}%
\newsavebox{\hlsmallboxand}%
\newsavebox{\hlsmallboxhash}%
\newsavebox{\hlsmallboxat}%
\newsavebox{\hlsmallboxpercent}% 
\newsavebox{\hlsmallboxhat}%
\newsavebox{\hlsmallboxsinglequote}%
\newsavebox{\hlsmallboxbacktick}%

\setbox\hlsmallboxopenbrace=\hbox{\begin{small}\verb.{.\end{small}}%
\setbox\hlsmallboxclosebrace=\hbox{\begin{small}\verb.}.\end{small}}%
\setbox\hlsmallboxlessthan=\hbox{\begin{small}\verb.<.\end{small}}%
\setbox\hlsmallboxdollar=\hbox{\begin{small}\verb.$.\end{small}}%
\setbox\hlsmallboxunderscore=\hbox{\begin{small}\verb._.\end{small}}%
\setbox\hlsmallboxand=\hbox{\begin{small}\verb.&.\end{small}}%
\setbox\hlsmallboxhash=\hbox{\begin{small}\verb.#.\end{small}}%
\setbox\hlsmallboxat=\hbox{\begin{small}\verb.@.\end{small}}%
\setbox\hlsmallboxbackslash=\hbox{\begin{small}\verb.\.\end{small}}%
\setbox\hlsmallboxgreaterthan=\hbox{\begin{small}\verb.>.\end{small}}%
\setbox\hlsmallboxpercent=\hbox{\begin{small}\verb.%.\end{small}}%
\setbox\hlsmallboxhat=\hbox{\begin{small}\verb.^.\end{small}}%
\setbox\hlsmallboxsinglequote=\hbox{\begin{small}\verb.'.\end{small}}%
\setbox\hlsmallboxbacktick=\hbox{\begin{small}\verb.`.\end{small}}%
\setbox\hlsmallboxhat=\hbox{\begin{small}\verb.^.\end{small}}%



\newsavebox{\hllargeboxclosebrace}%
\newsavebox{\hllargeboxopenbrace}%
\newsavebox{\hllargeboxbackslash}%
\newsavebox{\hllargeboxlessthan}%
\newsavebox{\hllargeboxgreaterthan}%
\newsavebox{\hllargeboxdollar}%
\newsavebox{\hllargeboxunderscore}%
\newsavebox{\hllargeboxand}%
\newsavebox{\hllargeboxhash}%
\newsavebox{\hllargeboxat}%
\newsavebox{\hllargeboxpercent}% 
\newsavebox{\hllargeboxhat}%
\newsavebox{\hllargeboxsinglequote}%
\newsavebox{\hllargeboxbacktick}%

\setbox\hllargeboxopenbrace=\hbox{\begin{large}\verb.{.\end{large}}%
\setbox\hllargeboxclosebrace=\hbox{\begin{large}\verb.}.\end{large}}%
\setbox\hllargeboxlessthan=\hbox{\begin{large}\verb.<.\end{large}}%
\setbox\hllargeboxdollar=\hbox{\begin{large}\verb.$.\end{large}}%
\setbox\hllargeboxunderscore=\hbox{\begin{large}\verb._.\end{large}}%
\setbox\hllargeboxand=\hbox{\begin{large}\verb.&.\end{large}}%
\setbox\hllargeboxhash=\hbox{\begin{large}\verb.#.\end{large}}%
\setbox\hllargeboxat=\hbox{\begin{large}\verb.@.\end{large}}%
\setbox\hllargeboxbackslash=\hbox{\begin{large}\verb.\.\end{large}}%
\setbox\hllargeboxgreaterthan=\hbox{\begin{large}\verb.>.\end{large}}%
\setbox\hllargeboxpercent=\hbox{\begin{large}\verb.%.\end{large}}%
\setbox\hllargeboxhat=\hbox{\begin{large}\verb.^.\end{large}}%
\setbox\hllargeboxsinglequote=\hbox{\begin{large}\verb.'.\end{large}}%
\setbox\hllargeboxbacktick=\hbox{\begin{large}\verb.`.\end{large}}%
\setbox\hllargeboxhat=\hbox{\begin{large}\verb.^.\end{large}}%



\newsavebox{\hlLargeboxclosebrace}%
\newsavebox{\hlLargeboxopenbrace}%
\newsavebox{\hlLargeboxbackslash}%
\newsavebox{\hlLargeboxlessthan}%
\newsavebox{\hlLargeboxgreaterthan}%
\newsavebox{\hlLargeboxdollar}%
\newsavebox{\hlLargeboxunderscore}%
\newsavebox{\hlLargeboxand}%
\newsavebox{\hlLargeboxhash}%
\newsavebox{\hlLargeboxat}%
\newsavebox{\hlLargeboxpercent}% 
\newsavebox{\hlLargeboxhat}%
\newsavebox{\hlLargeboxsinglequote}%
\newsavebox{\hlLargeboxbacktick}%

\setbox\hlLargeboxopenbrace=\hbox{\begin{Large}\verb.{.\end{Large}}%
\setbox\hlLargeboxclosebrace=\hbox{\begin{Large}\verb.}.\end{Large}}%
\setbox\hlLargeboxlessthan=\hbox{\begin{Large}\verb.<.\end{Large}}%
\setbox\hlLargeboxdollar=\hbox{\begin{Large}\verb.$.\end{Large}}%
\setbox\hlLargeboxunderscore=\hbox{\begin{Large}\verb._.\end{Large}}%
\setbox\hlLargeboxand=\hbox{\begin{Large}\verb.&.\end{Large}}%
\setbox\hlLargeboxhash=\hbox{\begin{Large}\verb.#.\end{Large}}%
\setbox\hlLargeboxat=\hbox{\begin{Large}\verb.@.\end{Large}}%
\setbox\hlLargeboxbackslash=\hbox{\begin{Large}\verb.\.\end{Large}}%
\setbox\hlLargeboxgreaterthan=\hbox{\begin{Large}\verb.>.\end{Large}}%
\setbox\hlLargeboxpercent=\hbox{\begin{Large}\verb.%.\end{Large}}%
\setbox\hlLargeboxhat=\hbox{\begin{Large}\verb.^.\end{Large}}%
\setbox\hlLargeboxsinglequote=\hbox{\begin{Large}\verb.'.\end{Large}}%
\setbox\hlLargeboxbacktick=\hbox{\begin{Large}\verb.`.\end{Large}}%
\setbox\hlLargeboxhat=\hbox{\begin{Large}\verb.^.\end{Large}}%



\newsavebox{\hlLARGEboxclosebrace}%
\newsavebox{\hlLARGEboxopenbrace}%
\newsavebox{\hlLARGEboxbackslash}%
\newsavebox{\hlLARGEboxlessthan}%
\newsavebox{\hlLARGEboxgreaterthan}%
\newsavebox{\hlLARGEboxdollar}%
\newsavebox{\hlLARGEboxunderscore}%
\newsavebox{\hlLARGEboxand}%
\newsavebox{\hlLARGEboxhash}%
\newsavebox{\hlLARGEboxat}%
\newsavebox{\hlLARGEboxpercent}% 
\newsavebox{\hlLARGEboxhat}%
\newsavebox{\hlLARGEboxsinglequote}%
\newsavebox{\hlLARGEboxbacktick}%

\setbox\hlLARGEboxopenbrace=\hbox{\begin{LARGE}\verb.{.\end{LARGE}}%
\setbox\hlLARGEboxclosebrace=\hbox{\begin{LARGE}\verb.}.\end{LARGE}}%
\setbox\hlLARGEboxlessthan=\hbox{\begin{LARGE}\verb.<.\end{LARGE}}%
\setbox\hlLARGEboxdollar=\hbox{\begin{LARGE}\verb.$.\end{LARGE}}%
\setbox\hlLARGEboxunderscore=\hbox{\begin{LARGE}\verb._.\end{LARGE}}%
\setbox\hlLARGEboxand=\hbox{\begin{LARGE}\verb.&.\end{LARGE}}%
\setbox\hlLARGEboxhash=\hbox{\begin{LARGE}\verb.#.\end{LARGE}}%
\setbox\hlLARGEboxat=\hbox{\begin{LARGE}\verb.@.\end{LARGE}}%
\setbox\hlLARGEboxbackslash=\hbox{\begin{LARGE}\verb.\.\end{LARGE}}%
\setbox\hlLARGEboxgreaterthan=\hbox{\begin{LARGE}\verb.>.\end{LARGE}}%
\setbox\hlLARGEboxpercent=\hbox{\begin{LARGE}\verb.%.\end{LARGE}}%
\setbox\hlLARGEboxhat=\hbox{\begin{LARGE}\verb.^.\end{LARGE}}%
\setbox\hlLARGEboxsinglequote=\hbox{\begin{LARGE}\verb.'.\end{LARGE}}%
\setbox\hlLARGEboxbacktick=\hbox{\begin{LARGE}\verb.`.\end{LARGE}}%
\setbox\hlLARGEboxhat=\hbox{\begin{LARGE}\verb.^.\end{LARGE}}%



\newsavebox{\hlhugeboxclosebrace}%
\newsavebox{\hlhugeboxopenbrace}%
\newsavebox{\hlhugeboxbackslash}%
\newsavebox{\hlhugeboxlessthan}%
\newsavebox{\hlhugeboxgreaterthan}%
\newsavebox{\hlhugeboxdollar}%
\newsavebox{\hlhugeboxunderscore}%
\newsavebox{\hlhugeboxand}%
\newsavebox{\hlhugeboxhash}%
\newsavebox{\hlhugeboxat}%
\newsavebox{\hlhugeboxpercent}% 
\newsavebox{\hlhugeboxhat}%
\newsavebox{\hlhugeboxsinglequote}%
\newsavebox{\hlhugeboxbacktick}%

\setbox\hlhugeboxopenbrace=\hbox{\begin{huge}\verb.{.\end{huge}}%
\setbox\hlhugeboxclosebrace=\hbox{\begin{huge}\verb.}.\end{huge}}%
\setbox\hlhugeboxlessthan=\hbox{\begin{huge}\verb.<.\end{huge}}%
\setbox\hlhugeboxdollar=\hbox{\begin{huge}\verb.$.\end{huge}}%
\setbox\hlhugeboxunderscore=\hbox{\begin{huge}\verb._.\end{huge}}%
\setbox\hlhugeboxand=\hbox{\begin{huge}\verb.&.\end{huge}}%
\setbox\hlhugeboxhash=\hbox{\begin{huge}\verb.#.\end{huge}}%
\setbox\hlhugeboxat=\hbox{\begin{huge}\verb.@.\end{huge}}%
\setbox\hlhugeboxbackslash=\hbox{\begin{huge}\verb.\.\end{huge}}%
\setbox\hlhugeboxgreaterthan=\hbox{\begin{huge}\verb.>.\end{huge}}%
\setbox\hlhugeboxpercent=\hbox{\begin{huge}\verb.%.\end{huge}}%
\setbox\hlhugeboxhat=\hbox{\begin{huge}\verb.^.\end{huge}}%
\setbox\hlhugeboxsinglequote=\hbox{\begin{huge}\verb.'.\end{huge}}%
\setbox\hlhugeboxbacktick=\hbox{\begin{huge}\verb.`.\end{huge}}%
\setbox\hlhugeboxhat=\hbox{\begin{huge}\verb.^.\end{huge}}%



\newsavebox{\hlHugeboxclosebrace}%
\newsavebox{\hlHugeboxopenbrace}%
\newsavebox{\hlHugeboxbackslash}%
\newsavebox{\hlHugeboxlessthan}%
\newsavebox{\hlHugeboxgreaterthan}%
\newsavebox{\hlHugeboxdollar}%
\newsavebox{\hlHugeboxunderscore}%
\newsavebox{\hlHugeboxand}%
\newsavebox{\hlHugeboxhash}%
\newsavebox{\hlHugeboxat}%
\newsavebox{\hlHugeboxpercent}% 
\newsavebox{\hlHugeboxhat}%
\newsavebox{\hlHugeboxsinglequote}%
\newsavebox{\hlHugeboxbacktick}%

\setbox\hlHugeboxopenbrace=\hbox{\begin{Huge}\verb.{.\end{Huge}}%
\setbox\hlHugeboxclosebrace=\hbox{\begin{Huge}\verb.}.\end{Huge}}%
\setbox\hlHugeboxlessthan=\hbox{\begin{Huge}\verb.<.\end{Huge}}%
\setbox\hlHugeboxdollar=\hbox{\begin{Huge}\verb.$.\end{Huge}}%
\setbox\hlHugeboxunderscore=\hbox{\begin{Huge}\verb._.\end{Huge}}%
\setbox\hlHugeboxand=\hbox{\begin{Huge}\verb.&.\end{Huge}}%
\setbox\hlHugeboxhash=\hbox{\begin{Huge}\verb.#.\end{Huge}}%
\setbox\hlHugeboxat=\hbox{\begin{Huge}\verb.@.\end{Huge}}%
\setbox\hlHugeboxbackslash=\hbox{\begin{Huge}\verb.\.\end{Huge}}%
\setbox\hlHugeboxgreaterthan=\hbox{\begin{Huge}\verb.>.\end{Huge}}%
\setbox\hlHugeboxpercent=\hbox{\begin{Huge}\verb.%.\end{Huge}}%
\setbox\hlHugeboxhat=\hbox{\begin{Huge}\verb.^.\end{Huge}}%
\setbox\hlHugeboxsinglequote=\hbox{\begin{Huge}\verb.'.\end{Huge}}%
\setbox\hlHugeboxbacktick=\hbox{\begin{Huge}\verb.`.\end{Huge}}%
\setbox\hlHugeboxhat=\hbox{\begin{Huge}\verb.^.\end{Huge}}%
 

\def\urltilda{\kern -.15em\lower .7ex\hbox{\~{}}\kern .04em}%

\newcommand{\hlstd}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.16,0.16,1}{#1}}
\newcommand{\hlesc}[1]{\textcolor[rgb]{1,0,1}{#1}}
\newcommand{\hlstr}[1]{\textcolor[rgb]{1,0,0}{#1}}
\newcommand{\hldstr}[1]{\textcolor[rgb]{0.51,0.51,0}{#1}}
\newcommand{\hlslc}[1]{\textcolor[rgb]{0.51,0.51,0.51}{\it{#1}}}
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.51,0.51,0.51}{\it{#1}}}
\newcommand{\hldir}[1]{\textcolor[rgb]{0,0.51,0}{#1}}
\newcommand{\hlsym}[1]{\textcolor[rgb]{0,0,0}{#1}}
\newcommand{\hlline}[1]{\textcolor[rgb]{0.33,0.33,0.33}{#1}}
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0,0,0}{\bf{#1}}}
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.51,0,0}{#1}}
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0,0,0}{\bf{#1}}}
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0,0,0.51}{#1}}


\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{Sweave}

%\VignetteIndexEntry{Using the package doRNG}
%\VignetteDepends{doRNG,doParallel,knitr,doRedis,rbenchmark}
%\VignetteCompiler{knitr}

\ifdefined\knitrout
  \renewenvironment{knitrout}{\begin{footnotesize}}{\end{footnotesize}}
\else
\fi

\usepackage{a4wide}
\usepackage{xspace}
\usepackage[colorlinks]{hyperref} % for hyperlinks

\usepackage{tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\usepackage[toc]{multitoc}


% add preamble from pkgmaker

%%%% PKGMAKER COMMANDS %%%%%%
% R
\let\proglang=\textit
\let\code=\texttt 
\newcommand{\Rcode}{\code}
\newcommand{\pkgname}[1]{\textit{#1}\xspace}
\newcommand{\Rpkg}[1]{\pkgname{#1} package\xspace}
\newcommand{\citepkg}[1]{\cite{#1}}

% CRAN
\newcommand{\CRANurl}[1]{\url{http://cran.r-project.org/package=#1}}
%% CRANpkg
\makeatletter
\def\CRANpkg{\@ifstar\@CRANpkg\@@CRANpkg}
\def\@CRANpkg#1{\href{http://cran.r-project.org/package=#1}{\pkgname{#1}}\footnote{\CRANurl{#1}}}
\def\@@CRANpkg#1{\href{http://cran.r-project.org/package=#1}{\pkgname{#1}} package\footnote{\CRANurl{#1}}}
\makeatother
%% citeCRANpkg
\newcommand{\citeCRANpkg}[1]{\CRANpkg{#1}~\cite{#1}}
\newcommand{\CRANnmf}{\href{http://cran.r-project.org/package=NMF}{CRAN}}
\newcommand{\CRANnmfURL}{\url{http://cran.r-project.org/package=NMF}}

% Bioconductor
\newcommand{\BioCurl}[1]{\url{http://www.bioconductor.org/packages/release/bioc/html/#1.html}}
\newcommand{\BioCpkg}[1]{\href{http://www.bioconductor.org/packages/release/bioc/html/#1.html}{\pkgname{#1}} package\footnote{\BioCurl{#1}}}
\newcommand{\citeBioCpkg}[1]{\BioCpkg{#1}~\cite{#1}}
% Bioconductor annotation
\newcommand{\BioCAnnurl}[1]{\url{http://www.bioconductor.org/packages/release/data/annotation/html/#1.html}}
\newcommand{\BioCAnnpkg}[1]{\href{http://www.bioconductor.org/packages/release/data/annotation/html/#1.html}{\Rcode{#1}} annotation package\footnote{\BioCAnnurl{#1}}}
\newcommand{\citeBioCAnnpkg}[1]{\BioCAnnpkg{#1}~\cite{#1}}

% GEO
\newcommand{\GEOurl}[1]{\href{http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=#1}{#1}\xspace}
\newcommand{\GEOhref}[1]{\GEOurl{#1}\footnote{\url{http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=#1}}}

% ArrayExpress
\newcommand{\ArrayExpressurl}[1]{\href{http://www.ebi.ac.uk/arrayexpress/experiments/#1}{#1}\xspace}
\newcommand{\ArrayExpresshref}[1]{\ArrayExpressurl{#1}\footnote{\url{http://www.ebi.ac.uk/arrayexpress/experiments/#1}}}

%%%% END: PKGMAKER COMMANDS %%%%%%




% REFERENCES
\usepackage[minnames=1,maxnames=2]{biblatex}
\AtEveryCitekey{\clearfield{url}}

\bibliography{/tmp/tmp.bt4n7VsAvc/doRNG/REFERENCES}



\bibliography{Rpackages}
\newcommand{\citet}[1]{\citeauthor{#1}~\cite{#1}}
%%

\newcommand{\graphwidth}{0.9\columnwidth}

% clever references
\usepackage[noabbrev, capitalise, nameinlink]{cleveref}

\newcommand{\dorng}{\code{\%dorng\%}\xspace}

\title{Using the \code{doRNG} package\\
{\small \Rpkg{doRNG} -- Version 1.4.4}}
\author{Renaud Gaujoux}

\begin{document}

\maketitle

\tableofcontents

\section*{Introduction}
\addcontentsline{toc}{section}{Introduction}

Research reproducibility is an issue of concern, e.g. in bioinformatics
\cite{Hothorn2011,Stodden2011,Ioannidis2008}.
Some analyses require multiple independent runs to be performed, or are amenable to a split-and-reduce scheme.
For example, some optimisation algorithms are run multiple times from different
random starting points, and the result that achieves the least approximation error is selected.
The \citeCRANpkg{foreach} provides a very convenient way to perform parallel computations, with different parallel environments such as MPI or Redis, using a transparent loop-like syntax:




\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }load{\ }and{\ }register{\ }parallel{\ }backend{\ }for{\ }multicore{\ }computations}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{library}\hlkeyword{(}\hlsymbol{doParallel}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## Loading required package: foreach
## Loading required package: iterators
## Loading required package: parallel
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hlsymbol{cl}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{makeCluster}\hlkeyword{(}\hlnumber{2}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{registerDoParallel}\hlkeyword{(}\hlsymbol{cl}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }perform{\ }5{\ }tasks{\ }in{\ }parallel}\hspace*{\fill}\\
\hlstd{}\hlsymbol{x}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlsymbol{i}{\ }\hlkeyword{+}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{unlist}\hlkeyword{(}\hlsymbol{x}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] 1.190 2.506 3.834 4.677 5.571
\end{verbatim}
\end{kframe}
\end{knitrout}


For each parallel environment a \emph{backend} is implemented as a specialised \code{\%dopar\%} operator, which performs the setup and pre/post-processing specifically required by the environment (e.g. export of variable to each worker).
The \code{foreach} function and the \code{\%dopar\%} operator handle the generic
parameter dispatch when the task are split between worker processes, as well
as the reduce step -- when the results are returned to the master worker.

When stochastic computations are involved, special random number generators must
be used to ensure that the separate computations are indeed statistically independent -- unless otherwise wanted -- and that the loop is reproducible.
In particular, standard \code{\%dopar\%} loops are not reproducible:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }with{\ }standard{\ }\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}:{\ }foreach{\ }loops{\ }are{\ }not{\ }reproducible}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{res}\hlkeyword{,}{\ }\hlsymbol{res2}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] FALSE
\end{verbatim}
\end{kframe}
\end{knitrout}


A random number generator commonly used to achieve reproducibility is the
combined multiple-recursive generator from \citet{Lecuyer1999}.
This generator can generate independent random streams, from a 6-length numeric seed.
The idea is then to generate a sequence of random stream of the same length
as the number of iteration (i.e. tasks) and use a different stream when computing each
one of them.

The \citeCRANpkg{doRNG} provides convenient ways to implement reproducible
parallel \code{foreach} loops, independently of the parallel backend used to perform the computation.
We illustrate its use, showing how non-reproducible loops can be made
reproducible, even when tasks are not scheduled in the same way in two separate
set of runs, e.g.
when the workers do not get to compute the same number of tasks or the number of workers is different.
The package has been tested with the \CRANpkg*{doParallel} and \CRANpkg*{doMPI}
packages \citepkg{doMPI,doParallel}, but should work with other backends such as
provided by the \citeCRANpkg{doRedis}. 

\section{The \texttt{\%dorng\%} operator}

The \Rpkg{doRNG} defines a new generic operator, \code{\%dorng\%}, to be used
with foreach loops, instead of the standard {\%dopar\%}.
Loops that use this operator are \emph{de facto} reproducible.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }load{\ }the{\ }doRNG{\ }package}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{library}\hlkeyword{(}\hlsymbol{doRNG}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## Loading required package: methods
## Loading required package: pkgmaker
## Loading required package: digest
## Loading required package: stringr
## Loading required package: codetools
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }using{\ }\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}:{\ }loops{\ }\usebox{\hlnormalsizeboxunderscore}are\usebox{\hlnormalsizeboxunderscore}{\ }reproducible}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{res}\hlkeyword{,}{\ }\hlsymbol{res2}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}


\subsection{How it works}
For a loop with $N$ iterations, the \code{\%dorng\%} operator internally
performs the following tasks:
\begin{enumerate}
  \item generate a sequence of random seeds $(S_i)_{1\leq i\leq N}$ for the \proglang{R} random number
  generator \code{"L'Ecuyer-CMRG"} \cite{Lecuyer1999}, using
  the function \code{nextRNGStream} from the \citeCRANpkg{parallel},
  which ensure the different RNG streams are statistically independent;
  \item modify the loop's \proglang{R} expression so that the random number
  generator is set to \code{"L'Ecuyer-CMRG"} at the beginning of each
  iteration, and is seeded with consecutive seeds in $(S_n)$: iteration $i$ is
  seeded with $S_i$, $1\leq i\leq N$;
  \item call the standard \code{\%dopar\%} operator, which in turn
  calls the relevant (i.e. registered) foreach parallel backend;
  \item store the whole sequence of random seeds as an attribute in the result
  object:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{attr}\hlkeyword{(}\hlsymbol{res}\hlkeyword{,}{\ }\hlstring{"{}rng"{}}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [[1]]
## [1]         407   642048078    81368183 -2093158836   506506973  1421492218 -1906381517
## 
## [[2]]
## [1]         407  1340772676 -1389246211  -999053355  -953732024  1888105061  2010658538
## 
## [[3]]
## [1]         407 -1318496690  -948316584   683309249  -990823268 -1895972179  1275914972
## 
## [[4]]
## [1]         407   524763474  1715794407  1887051490 -1833874283   494155061 -1221391662
## 
## [[5]]
## [1]         407 -1816009034  -580124020  1603250023   817712173   190009158  -706984535
## 
\end{verbatim}
\end{kframe}
\end{knitrout}

\end{enumerate}

\subsection{Seeding computations}

Sequences of random streams for \code{"L'Ecuyer-CMRG"} are generated
using a 6-length integer seed:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{nextRNGStream}\hlkeyword{(}\hlnumber{1}\hlkeyword{:}\hlnumber{6}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## Error: invalid value of 'seed'
\end{verbatim}
\end{kframe}
\end{knitrout}


However, the \code{\%dorng\%} operator provides alternative -- convenient --
ways of seeding reproducible loops.

\begin{description}
  \item[\code{set.seed}:] as shown above, calling \code{set.seed} before the
  loop ensure reproducibility of the results, using a single integer as a seed. 
  The actual 6-length seed is then generated with an internal call to 
  \code{RNGkind("L'Ecuyer-CMRG")}.
  \item[\code{.options.RNG} with single integer:] the \dorng operator
  support options that can be passed in the \code{foreach} statement, containing
  arguments for the internal call to \code{set.seed}:
  
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }use{\ }a{\ }single{\ }numeric{\ }as{\ }a{\ }seed}\hspace*{\fill}\\
\hlstd{}\hlsymbol{s}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlnumber{123}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{s2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlnumber{123}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{s}\hlkeyword{,}{\ }\hlsymbol{s2}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}


\noindent \textbf{Note}: calling \code{set.seed} before the loop is equivalent 
to passing the seed in \code{.options.RNG}. 
See \cref{sec:set_seed} for more details.

\medskip
The kind of Normal generator may also be passed in \code{.options.RNG}:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}\usebox{\hlnormalsizeboxhash}{\ }Pass{\ }the{\ }Normal{\ }RNG{\ }kind{\ }to{\ }use{\ }within{\ }the{\ }loop{\ }results{\ }are{\ }identical{\ }if{\ }not{\ }using{\ }the}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}\usebox{\hlnormalsizeboxhash}{\ }Normal{\ }kind{\ }in{\ }the{\ }loop}\hspace*{\fill}\\
\hlstd{}\hlsymbol{optsN}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{list}\hlkeyword{(}\hlnumber{123}\hlkeyword{,}{\ }\hlargument{normal.kind}{\ }\hlargument{=}{\ }\hlstring{"{}Ahrens"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resN.U}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlsymbol{optsN}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{resN.U}\hlkeyword{[}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{res}\hlkeyword{[}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{]}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Results{\ }are{\ }different{\ }if{\ }the{\ }Normal{\ }kind{\ }is{\ }used{\ }and{\ }is{\ }not{\ }the{\ }same}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resN}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlnumber{123}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resN1}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlsymbol{optsN}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resN2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlsymbol{optsN}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{resN}\hlkeyword{[}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{resN1}\hlkeyword{[}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{]}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] FALSE
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{resN1}\hlkeyword{[}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{resN2}\hlkeyword{[}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{]}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}

\item[\code{.options.RNG} with 6-length:] the actual 6-length integer seed used
for the first RNG stream may be passed via \code{options.RNG}: 
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }use{\ }a{\ }6-length{\ }numeric}\hspace*{\fill}\\
\hlstd{}\hlsymbol{s}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{6}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{attr}\hlkeyword{(}\hlsymbol{s}\hlkeyword{,}{\ }\hlstring{"{}rng"{}}\hlkeyword{)}\hlkeyword{[}\hlnumber{1}\hlkeyword{:}\hlnumber{3}\hlkeyword{]}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [[1]]
## [1] 407   1   2   3   4   5   6
## 
## [[2]]
## [1]         407  -447371532   542750874  -935969228  -269326340   701604884 -1748056907
## 
## [[3]]
## [1]         407   311773008 -1393648596   433058656  -545474683  2059732357   994549473
## 
\end{verbatim}
\end{kframe}
\end{knitrout}

\item[\code{.options.RNG} with 7-length:] a 7-length integer seed may also be
passed via \code{options.RNG}, which is useful to seed a loop with the value of
\code{.Random.seed} as used in some iteration of another loop\footnote{Note that
the RNG kind is then always required to be the \code{"L'Ecuyer-CMRG"}, i.e.
the first element of the seed must have unit 7 (e.g. 407 or 107).}:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }use{\ }a{\ }7-length{\ }numeric,{\ }used{\ }as{\ }first{\ }value{\ }for{\ }.Random.seed}\hspace*{\fill}\\
\hlstd{}\hlsymbol{seed}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{attr}\hlkeyword{(}\hlsymbol{res}\hlkeyword{,}{\ }\hlstring{"{}rng"{}}\hlkeyword{)}\hlkeyword{[[}\hlnumber{2}\hlkeyword{]}\hlkeyword{]}\hspace*{\fill}\\
\hlstd{}\hlsymbol{s}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlsymbol{seed}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{s}\hlkeyword{[}\hlnumber{1}\hlkeyword{:}\hlnumber{4}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{res}\hlkeyword{[}\hlnumber{2}\hlkeyword{:}\hlnumber{5}\hlkeyword{]}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}

\item[\code{.options.RNG} with complete sequence of seeds:] the complete
description of the sequence of seeds to be used may be
passed via \code{options.RNG}, as a list or a matrix with the seeds in columns.
This is useful to seed a loop exactly as desired, e.g. using an RNG
other than \code{"L'Ecuyer-CMRG"}, or using different RNG kinds in each iteration, which probably have different seed
length, in order to compare their stochastic properties.
It also allows to reproduce \code{\%dorng\%} loops without knowing their seeding
details:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }reproduce{\ }previous{\ }\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}{\ }loop}\hspace*{\fill}\\
\hlstd{}\hlsymbol{s}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlsymbol{res}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{s}\hlkeyword{,}{\ }\hlsymbol{res}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}\usebox{\hlnormalsizeboxhash}{\ }use{\ }completely{\ }custom{\ }sequence{\ }of{\ }seeds{\ }(e.g.{\ }using{\ }RNG{\ }\usebox{\hlnormalsizeboxsinglequote}Marsaglia-Multicarry\usebox{\hlnormalsizeboxsinglequote}){\ }as{\ }a}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}\usebox{\hlnormalsizeboxhash}{\ }matrix}\hspace*{\fill}\\
\hlstd{}\hlsymbol{seedM}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{rbind}\hlkeyword{(}\hlfunctioncall{rep}\hlkeyword{(}\hlnumber{401}\hlkeyword{,}{\ }\hlnumber{5}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{mapply}\hlkeyword{(}\hlsymbol{rep}\hlkeyword{,}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlnumber{2}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{seedM}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
##      [,1] [,2] [,3] [,4] [,5]
## [1,]  401  401  401  401  401
## [2,]    1    2    3    4    5
## [3,]    1    2    3    4    5
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hlsymbol{sM}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlsymbol{seedM}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }same{\ }seeds{\ }passed{\ }as{\ }a{\ }list}\hspace*{\fill}\\
\hlstd{}\hlsymbol{seedL}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{lapply}\hlkeyword{(}\hlfunctioncall{seq}\hlkeyword{(}\hlfunctioncall{ncol}\hlkeyword{(}\hlsymbol{seedM}\hlkeyword{)}\hlkeyword{)}\hlkeyword{,}{\ }\hlkeyword{function}\hlkeyword{(}\hlformalargs{i}\hlkeyword{)}{\ }\hlsymbol{seedM}\hlkeyword{[}\hlkeyword{,}{\ }\hlsymbol{i}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{sL}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlsymbol{seedL}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{sL}\hlkeyword{,}{\ }\hlsymbol{sM}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}

\end{description}

\subsection{Difference between \texttt{set.seed} and \texttt{.options.RNG}}
\label{sec:set_seed}

While it is equivalent to seed \dorng loops with \code{set.seed} and \code{.options.RNG},
it is important to note that the result depends on the current RNG kind
\footnote{See \cref{sec:issues} about a bug in versions < 1.4 on this feature.}:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }default{\ }RNG{\ }kind}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{RNGkind}\hlkeyword{(}\hlstring{"{}default"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{def}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlnumber{123}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Marsaglia-Multicarry}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{RNGkind}\hlkeyword{(}\hlstring{"{}Marsaglia"{}}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{mars}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlnumber{123}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{def}\hlkeyword{,}{\ }\hlsymbol{mars}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] FALSE
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }revert{\ }to{\ }default{\ }RNG{\ }kind}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{RNGkind}\hlkeyword{(}\hlstring{"{}default"{}}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}


This is a ``normal'' behaviour, which is a side-effect of the expected equivalence between 
\code{set.seed} and \code{.options.RNG}.
This should not be a problem for reproducibility though, as R RNGs are stable across versions, 
and loops are most of the time used with the default RNG settings. 
In order to ensure seeding is independent from the current RNG, one has to pass a 
7-length numeric seed to \code{.options.RNG}, which is then used directly as a value 
for \code{.Random.seed} (see below).

\section{Parallel environment independence}
An important feature of \code{\%dorng\%} loops is that their result is
independent of the underlying parallel physical settings.
Two separate runs seeded with the same value will always produce the same
results.
Whether they use the same number of worker processes, parallel backend or
task scheduling does not influence the final result.
This also applies to computations performed sequentially with the \code{doSEQ}
backend.
The following code illustrates this feature using 2 or 3 workers.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }define{\ }a{\ }stochastic{\ }task{\ }to{\ }perform}\hspace*{\fill}\\
\hlstd{}\hlsymbol{task}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlkeyword{function}\hlkeyword{(}\hlkeyword{)}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlargument{pid}\hlargument{=}\hlfunctioncall{Sys.getpid}\hlkeyword{(}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{val}\hlargument{=}\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }using{\ }the{\ }previously{\ }registered{\ }cluster{\ }with{\ }2{\ }workers}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}2workers}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.combine}\hlargument{=}\hlsymbol{rbind}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{task}\hlkeyword{(}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }stop{\ }cluster}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{stopCluster}\hlkeyword{(}\hlsymbol{cl}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Sequential{\ }computation}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{registerDoSEQ}\hlkeyword{(}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}seq}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.combine}\hlargument{=}\hlsymbol{rbind}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{task}\hlkeyword{(}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Using{\ }3{\ }workers}\hspace*{\fill}\\
\hlstd{}\hlsymbol{cl}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{makeCluster}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{registerDoParallel}\hlkeyword{(}\hlsymbol{cl}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}3workers}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{,}{\ }\hlargument{.combine}\hlargument{=}\hlsymbol{rbind}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{task}\hlkeyword{(}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }task{\ }schedule{\ }is{\ }different}\hspace*{\fill}\\
\hlstd{}\hlsymbol{pid}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{rbind}\hlkeyword{(}\hlargument{res1}\hlargument{=}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}seq}\hlkeyword{[}\hlkeyword{,}\hlnumber{1}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}2workers}\hlkeyword{[}\hlkeyword{,}\hlnumber{1}\hlkeyword{]}\hlkeyword{,}{\ }\hlargument{res2}\hlargument{=}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}3workers}\hlkeyword{[}\hlkeyword{,}\hlnumber{1}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{storage.mode}\hlkeyword{(}\hlsymbol{pid}\hlkeyword{)}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlstring{\usebox{\hlnormalsizeboxsinglequote}integer\usebox{\hlnormalsizeboxsinglequote}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{pid}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
##      result.1 result.2 result.3 result.4 result.5
## res1    19944    19944    19944    19944    19944
##         19955    19964    19955    19964    19955
## res2    19977    19986    19995    19986    19995
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }results{\ }are{\ }identical}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}seq}\hlkeyword{[}\hlkeyword{,}\hlnumber{2}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}2workers}\hlkeyword{[}\hlkeyword{,}\hlnumber{2}\hlkeyword{]}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxand}\usebox{\hlnormalsizeboxand}}{\ }\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}2workers}\hlkeyword{[}\hlkeyword{,}\hlnumber{2}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}3workers}\hlkeyword{[}\hlkeyword{,}\hlnumber{2}\hlkeyword{]}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}


\section{Reproducible \texttt{\%dopar\%} loops}

The \Rpkg{doRNG} also provides a non-invasive way to convert \code{\%dopar\%}
loops into reproducible loops, i.e. without changing their actual definition.
It is useful to quickly ensure the reproducibility of existing code or functions
whose definition is not accessible (e.g. from other packages).
This is achieved by registering the \code{doRNG} backend:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{registerDoRNG}\hlkeyword{(}\hlnumber{123}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}dopar}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}dopar}\hlkeyword{,}{\ }\hlsymbol{res}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{attr}\hlkeyword{(}\hlsymbol{res\usebox{\hlnormalsizeboxunderscore}dopar}\hlkeyword{,}{\ }\hlstring{"{}rng"{}}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [[1]]
## [1]         407   642048078    81368183 -2093158836   506506973  1421492218 -1906381517
## 
## [[2]]
## [1]         407  1340772676 -1389246211  -999053355  -953732024  1888105061  2010658538
## 
## [[3]]
## [1]         407 -1318496690  -948316584   683309249  -990823268 -1895972179  1275914972
## 
## [[4]]
## [1]         407   524763474  1715794407  1887051490 -1833874283   494155061 -1221391662
## 
## [[5]]
## [1]         407 -1816009034  -580124020  1603250023   817712173   190009158  -706984535
## 
\end{verbatim}
\end{kframe}
\end{knitrout}


\section{Reproducibile sets of loops}

Sequences of multiple loops are reproducible, whether using the
\code{\%dorng\%} operator or the registered \code{doRNG} backend:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{456}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{s1}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{s2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }the{\ }two{\ }loops{\ }do{\ }not{\ }use{\ }the{\ }same{\ }streams:{\ }different{\ }results}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{s1}\hlkeyword{,}{\ }\hlsymbol{s2}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] FALSE
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }but{\ }the{\ }sequence{\ }of{\ }loops{\ }is{\ }reproducible{\ }as{\ }a{\ }whole}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{set.seed}\hlkeyword{(}\hlnumber{456}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{r1}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{r2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{r1}\hlkeyword{,}{\ }\hlsymbol{s1}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxand}\usebox{\hlnormalsizeboxand}}{\ }\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{r2}\hlkeyword{,}{\ }\hlsymbol{s2}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }one{\ }can{\ }equivalently{\ }register{\ }the{\ }doRNG{\ }backend{\ }and{\ }use{\ }\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{registerDoRNG}\hlkeyword{(}\hlnumber{456}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{r1}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{r2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}\hlargument{=}\hlnumber{1}\hlkeyword{:}\hlnumber{5}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}{\ }\hlfunctioncall{runif}\hlkeyword{(}\hlnumber{3}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{r1}\hlkeyword{,}{\ }\hlsymbol{s1}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxand}\usebox{\hlnormalsizeboxand}}{\ }\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{r2}\hlkeyword{,}{\ }\hlsymbol{s2}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## [1] TRUE
\end{verbatim}
\end{kframe}
\end{knitrout}


\section{Performance overhead}

The extra setup performed by the \code{\%dorng\%} operator leads to a slight
performance over-head, which might be significant for very quick computations, but should
not be a problem for realistic computations.
The benchmarks below show that a \code{\%dorng\%} loop may take up to two
seconds more than the equivalent \code{\%dopar\%} loop, which is not significant
in practice, where parallelised computations typically take several minutes.  

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }load{\ }rbenchmark}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{library}\hlkeyword{(}\hlsymbol{rbenchmark}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }comparison{\ }is{\ }done{\ }on{\ }sequential{\ }computations}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{registerDoSEQ}\hlkeyword{(}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlsymbol{rPar}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlkeyword{function}\hlkeyword{(}\hlformalargs{n}\hlkeyword{,}{\ }\hlformalargs{s}{\ }\hleqformalargs{=}{\ }\hlnumber{0}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{Sys.sleep}\hlkeyword{(}\hlsymbol{s}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlsymbol{rRNG}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlkeyword{function}\hlkeyword{(}\hlformalargs{n}\hlkeyword{,}{\ }\hlformalargs{s}{\ }\hleqformalargs{=}{\ }\hlnumber{0}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{Sys.sleep}\hlkeyword{(}\hlsymbol{s}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }run{\ }benchmark}\hspace*{\fill}\\
\hlstd{}\hlsymbol{cmp}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{benchmark}\hlkeyword{(}\hlfunctioncall{rPar}\hlkeyword{(}\hlnumber{10}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rRNG}\hlkeyword{(}\hlnumber{10}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rPar}\hlkeyword{(}\hlnumber{50}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rRNG}\hlkeyword{(}\hlnumber{50}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rPar}\hlkeyword{(}\hlnumber{100}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rRNG}\hlkeyword{(}\hlnumber{100}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rPar}\hlkeyword{(}\hlnumber{10}\hlkeyword{,}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlnumber{0.1}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rRNG}\hlkeyword{(}\hlnumber{10}\hlkeyword{,}{\ }\hlnumber{0.1}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rPar}\hlkeyword{(}\hlnumber{100}\hlkeyword{,}{\ }\hlnumber{0.01}\hlkeyword{)}\hlkeyword{,}{\ }\hlfunctioncall{rRNG}\hlkeyword{(}\hlnumber{100}\hlkeyword{,}{\ }\hlnumber{0.01}\hlkeyword{)}\hlkeyword{,}{\ }\hlargument{replications}{\ }\hlargument{=}{\ }\hlnumber{50}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }order{\ }by{\ }increasing{\ }elapsed{\ }time}\hspace*{\fill}\\
\hlstd{}\hlsymbol{cmp}\hlkeyword{[}\hlfunctioncall{order}\hlkeyword{(}\hlsymbol{cmp}\hlkeyword{\usebox{\hlnormalsizeboxdollar}}\hlsymbol{elapsed}\hlkeyword{)}\hlkeyword{,}{\ }\hlkeyword{]}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
##               test replications elapsed relative user.self sys.self user.child sys.child
## 1         rPar(10)           50   0.539    1.000     0.536    0.004          0         0
## 2         rRNG(10)           50   0.937    1.738     0.920    0.012          0         0
## 3         rPar(50)           50   1.862    3.455     1.856    0.004          0         0
## 4         rRNG(50)           50   3.221    5.976     3.040    0.008          0         0
## 5        rPar(100)           50   3.768    6.991     3.608    0.004          0         0
## 6        rRNG(100)           50   5.712   10.597     5.629    0.024          0         0
## 7    rPar(10, 0.1)           50  50.744   94.145     0.680    0.004          0         0
## 8    rRNG(10, 0.1)           50  51.188   94.968     1.100    0.024          0         0
## 9  rPar(100, 0.01)           50  54.586  101.273     4.228    0.040          0         0
## 10 rRNG(100, 0.01)           50  56.734  105.258     6.353    0.060          0         0
\end{verbatim}
\end{kframe}
\end{knitrout}



\section{Nested and conditional loops}
\label{sec:nested}

Nested and conditional foreach loops are currently not supported and generate an error:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }nested{\ }loop}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{10}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{j}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{i}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## Error: nested/conditional foreach loops are not supported yet. See the package's vignette
## for a work around.
\end{verbatim}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }conditional{\ }loop}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlnumber{10}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{when}\hlkeyword{(}\hlsymbol{i}\hlkeyword{\usebox{\hlnormalsizeboxpercent}\usebox{\hlnormalsizeboxpercent}}\hlnumber{2}{\ }=={\ }\hlnumber{0}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\mbox{}
\normalfont
\end{flushleft}
\begin{verbatim}
## Error: nested/conditional foreach loops are not supported yet. See the package's vignette
## for a work around.
\end{verbatim}
\end{kframe}
\end{knitrout}


In this section, we propose a general work around for this kind of loops, that will 
eventually be incorporated in the \code{\%dorng\%} operator -- when I find out how to 
mimic its behaviour from the operator itself.

\subsection{Nested loops}

The idea is to create a sequence of RNG seeds before the outer loop, and use each 
of them successively to set the RNG in the inner loop -- which is exactly what \code{\%dorng\%} does 
for simple loops:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }doRNG{\ }must{\ }not{\ }be{\ }registered}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{registerDoParallel}\hlkeyword{(}\hlsymbol{cl}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }generate{\ }sequence{\ }of{\ }seeds{\ }of{\ }length{\ }the{\ }number{\ }of{\ }computations}\hspace*{\fill}\\
\hlstd{}\hlsymbol{n}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlnumber{10}\hspace*{\fill}\\
\hlstd{}\hlsymbol{p}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlnumber{5}\hspace*{\fill}\\
\hlstd{}\hlsymbol{rng}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{RNGseq}\hlkeyword{(}\hlsymbol{n}{\ }\hlkeyword{*}{\ }\hlsymbol{p}\hlkeyword{,}{\ }\hlnumber{1234}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }run{\ }standard{\ }nested{\ }foreach{\ }loop}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{j}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{p}\hlkeyword{,}{\ }\hlargument{r}{\ }\hlargument{=}{\ }\hlsymbol{rng}\hlkeyword{[}\hlkeyword{(}\hlsymbol{i}{\ }\hlkeyword{-}{\ }\hlnumber{1}\hlkeyword{)}{\ }\hlkeyword{*}{\ }\hlsymbol{p}{\ }\hlkeyword{+}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{p}\hlkeyword{]}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }RNG{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{r}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlsymbol{j}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Compare{\ }against{\ }the{\ }equivalent{\ }sequential{\ }computations}\hspace*{\fill}\\
\hlstd{}\hlsymbol{k}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlnumber{1}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{j}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{p}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}do\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{rng}\hlkeyword{[[}\hlsymbol{k}\hlkeyword{]}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlsymbol{k}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlsymbol{k}{\ }\hlkeyword{+}{\ }\hlnumber{1}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlsymbol{j}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{stopifnot}\hlkeyword{(}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{res}\hlkeyword{,}{\ }\hlsymbol{res2}\hlkeyword{)}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}


The following is a more complex example with unequal -- but \textbf{known \emph{a priori}} -- 
numbers of iterations performed in the inner loops:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }generate{\ }sequence{\ }of{\ }seeds{\ }of{\ }length{\ }the{\ }number{\ }of{\ }computations}\hspace*{\fill}\\
\hlstd{}\hlsymbol{n}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlnumber{10}\hspace*{\fill}\\
\hlstd{}\hlsymbol{rng}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{RNGseq}\hlkeyword{(}\hlsymbol{n}{\ }\hlkeyword{*}{\ }\hlkeyword{(}\hlsymbol{n}{\ }\hlkeyword{+}{\ }\hlnumber{1}\hlkeyword{)}\hlkeyword{/}\hlnumber{2}\hlkeyword{,}{\ }\hlnumber{1234}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }run{\ }standard{\ }nested{\ }foreach{\ }loop}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{j}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{i}\hlkeyword{,}{\ }\hlargument{r}{\ }\hlargument{=}{\ }\hlsymbol{rng}\hlkeyword{[}\hlkeyword{(}\hlsymbol{i}{\ }\hlkeyword{-}{\ }\hlnumber{1}\hlkeyword{)}{\ }\hlkeyword{*}{\ }\hlsymbol{i}\hlkeyword{/}\hlnumber{2}{\ }\hlkeyword{+}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{i}\hlkeyword{]}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }RNG{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{r}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlsymbol{j}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Compare{\ }against{\ }the{\ }equivalent{\ }sequential{\ }computations}\hspace*{\fill}\\
\hlstd{}\hlsymbol{k}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlnumber{1}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res2}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{j}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{i}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}do\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{rng}\hlkeyword{[[}\hlsymbol{k}\hlkeyword{]}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlsymbol{k}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlsymbol{k}{\ }\hlkeyword{+}{\ }\hlnumber{1}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlsymbol{j}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{stopifnot}\hlkeyword{(}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{res}\hlkeyword{,}{\ }\hlsymbol{res2}\hlkeyword{)}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}


\subsection{Conditional loops}
The work around used for nested loops applies to conditional loops that use the \code{when()} 
clause.
It ensures that the RNG seed use for a given inner iteration does not depend on the 
filter, but only on its index in the unconditional-unfolded loop:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }un-conditional{\ }single{\ }loop}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resAll}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{,}{\ }\hlargument{.options.RNG}{\ }\hlargument{=}{\ }\hlnumber{1234}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dorng\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }generate{\ }sequence{\ }of{\ }RNG}\hspace*{\fill}\\
\hlstd{}\hlsymbol{rng}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{RNGseq}\hlkeyword{(}\hlsymbol{n}\hlkeyword{,}{\ }\hlnumber{1234}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }conditional{\ }loop:{\ }even{\ }iterations}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resEven}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{,}{\ }\hlargument{r}{\ }\hlargument{=}{\ }\hlsymbol{rng}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{when}\hlkeyword{(}\hlsymbol{i}\hlkeyword{\usebox{\hlnormalsizeboxpercent}\usebox{\hlnormalsizeboxpercent}}\hlnumber{2}{\ }=={\ }\hlnumber{0}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }RNG{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{r}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }conditional{\ }loop:{\ }odd{\ }iterations}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resOdd}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{,}{\ }\hlargument{r}{\ }\hlargument{=}{\ }\hlsymbol{rng}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{when}\hlkeyword{(}\hlsymbol{i}\hlkeyword{\usebox{\hlnormalsizeboxpercent}\usebox{\hlnormalsizeboxpercent}}\hlnumber{2}{\ }=={\ }\hlnumber{1}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }RNG{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{r}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }conditional{\ }loop:{\ }only{\ }first{\ }2{\ }and{\ }last{\ }2}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resFL}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{,}{\ }\hlargument{r}{\ }\hlargument{=}{\ }\hlsymbol{rng}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{when}\hlkeyword{(}\hlsymbol{i}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}in\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{c}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{2}\hlkeyword{,}{\ }\hlsymbol{n}{\ }\hlkeyword{-}{\ }\hlnumber{1}\hlkeyword{,}{\ }\hlsymbol{n}\hlkeyword{)}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }RNG{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{r}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }compare{\ }results}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{stopifnot}\hlkeyword{(}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{resAll}\hlkeyword{[}\hlfunctioncall{seq}\hlkeyword{(}\hlnumber{2}\hlkeyword{,}{\ }\hlsymbol{n}\hlkeyword{,}{\ }\hlargument{by}{\ }\hlargument{=}{\ }\hlnumber{2}\hlkeyword{)}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{resEven}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{stopifnot}\hlkeyword{(}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{resAll}\hlkeyword{[}\hlfunctioncall{seq}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlsymbol{n}\hlkeyword{,}{\ }\hlargument{by}{\ }\hlargument{=}{\ }\hlnumber{2}\hlkeyword{)}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{resOdd}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{stopifnot}\hlkeyword{(}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{resAll}\hlkeyword{[}\hlfunctioncall{c}\hlkeyword{(}\hlnumber{1}\hlkeyword{,}{\ }\hlnumber{2}\hlkeyword{,}{\ }\hlsymbol{n}{\ }\hlkeyword{-}{\ }\hlnumber{1}\hlkeyword{,}{\ }\hlsymbol{n}\hlkeyword{)}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{resFL}\hlkeyword{)}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}


\subsection{Nested conditional loops}

Conditional nested loops may use the same work around, as shown in this intricate 
example:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }generate{\ }sequence{\ }of{\ }seeds{\ }of{\ }length{\ }the{\ }number{\ }of{\ }computations}\hspace*{\fill}\\
\hlstd{}\hlsymbol{n}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlnumber{10}\hspace*{\fill}\\
\hlstd{}\hlsymbol{rng}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{RNGseq}\hlkeyword{(}\hlsymbol{n}{\ }\hlkeyword{*}{\ }\hlkeyword{(}\hlsymbol{n}{\ }\hlkeyword{+}{\ }\hlnumber{1}\hlkeyword{)}\hlkeyword{/}\hlnumber{2}\hlkeyword{,}{\ }\hlnumber{1234}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }run{\ }standard{\ }nested{\ }foreach{\ }loop}\hspace*{\fill}\\
\hlstd{}\hlsymbol{res}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{when}\hlkeyword{(}\hlsymbol{i}\hlkeyword{\usebox{\hlnormalsizeboxpercent}\usebox{\hlnormalsizeboxpercent}}\hlnumber{2}{\ }=={\ }\hlnumber{0}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{j}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{i}\hlkeyword{,}{\ }\hlargument{r}{\ }\hlargument{=}{\ }\hlsymbol{rng}\hlkeyword{[}\hlkeyword{(}\hlsymbol{i}{\ }\hlkeyword{-}{\ }\hlnumber{1}\hlkeyword{)}{\ }\hlkeyword{*}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlsymbol{i}\hlkeyword{/}\hlnumber{2}{\ }\hlkeyword{+}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{i}\hlkeyword{]}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}dopar\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }RNG{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{r}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlsymbol{j}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }Compare{\ }against{\ }the{\ }equivalent{\ }sequential{\ }computations}\hspace*{\fill}\\
\hlstd{}\hlsymbol{k}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlnumber{1}\hspace*{\fill}\\
\hlstd{}\hlsymbol{resAll}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{i}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{n}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}:\usebox{\hlnormalsizeboxpercent}}{\ }\hlfunctioncall{foreach}\hlkeyword{(}\hlargument{j}{\ }\hlargument{=}{\ }\hlnumber{1}\hlkeyword{:}\hlsymbol{i}\hlkeyword{)}{\ }\hlkeyword{\usebox{\hlnormalsizeboxpercent}do\usebox{\hlnormalsizeboxpercent}}{\ }\hlkeyword{\usebox{\hlnormalsizeboxopenbrace}}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }set{\ }seed}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlpackage{doRNG}\hlkeyword{::}\hlfunctioncall{setRNG}\hlkeyword{(}\hlsymbol{rng}\hlkeyword{[[}\hlsymbol{k}\hlkeyword{]}\hlkeyword{]}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlsymbol{k}{\ }\hlassignement{\usebox{\hlnormalsizeboxlessthan}-}{\ }\hlsymbol{k}{\ }\hlkeyword{+}{\ }\hlnumber{1}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlcomment{\usebox{\hlnormalsizeboxhash}{\ }do{\ }your{\ }own{\ }computation{\ }...}\hspace*{\fill}\\
\hlstd{}{\ }{\ }{\ }{\ }\hlfunctioncall{c}\hlkeyword{(}\hlsymbol{i}\hlkeyword{,}{\ }\hlsymbol{j}\hlkeyword{,}{\ }\hlfunctioncall{rnorm}\hlkeyword{(}\hlnumber{1}\hlkeyword{)}\hlkeyword{)}\hspace*{\fill}\\
\hlstd{}\hlkeyword{\usebox{\hlnormalsizeboxclosebrace}}\hspace*{\fill}\\
\hlstd{}\hspace*{\fill}\\
\hlstd{}\hlfunctioncall{stopifnot}\hlkeyword{(}\hlfunctioncall{identical}\hlkeyword{(}\hlsymbol{resAll}\hlkeyword{[}\hlfunctioncall{seq}\hlkeyword{(}\hlnumber{2}\hlkeyword{,}{\ }\hlsymbol{n}\hlkeyword{,}{\ }\hlargument{by}{\ }\hlargument{=}{\ }\hlnumber{2}\hlkeyword{)}\hlkeyword{]}\hlkeyword{,}{\ }\hlsymbol{res}\hlkeyword{)}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}


\section{Known issues}
\label{sec:issues}

\begin{itemize}
\item Nested and/or conditional foreach loops using the operator \code{\%:\%} are not 
currently not supported (see \cref{sec:nested} for a work around).
\item An error is thrown in \code{doRNG} 1.2.6, when the package \code{iterators} was not loaded, when used with 
\code{foreach} >= 1.4.
\item There was a bug in versions prior to \code{1.4}, which caused \code{set.seed} and 
\code{.options.RNG} not to be equivalent when the current RNG was \code{"L'Ecuyer-CMRG"}.
This behaviour can still be reproduced by setting:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{doRNGversion}\hlkeyword{(}\hlstring{"{}1.3"{}}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}

To revert to the latest default behaviour:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{doRNGversion}\hlkeyword{(}NULL\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}

\end{itemize} 

\section{News and changes}

{\scriptsize
\begin{verbatim}

*************************************************************************
*                       Changes in version 1.4.2                        *
*************************************************************************

CHANGES
    o doRNG now depends on the package pkgmaker (>= 0.6.2)
    o improved vignette

*************************************************************************
*                       Changes in version 1.4.1                        *
*************************************************************************

CHANGES
    o when the current RNG was L'Ecuyer-CMRG, unseeded loops now use 
    the current RNG stream as for the first stream in the RNG sequence 
    and changes the current RNG to the next RNG stream of the last stream 
    in the sequence. 

BUG FIX
    o fix error "'iter' not found" due to changes in foreach package 
    dependencies -- that was announced by Rich Calaway.
    o loops seeded with set.seed and .options.RNG were not reproducible
    when current RNG was L'Ecuyer-CMRG (reported by Zhang Peng)
    o separate unseeded loops were sharing most of their streams, 
    when current RNG was L'Ecuyer-CMRG the RNG seed.
    o nested/conditional loops were crashing with a bad error. 
    They are still not supported but the error message is nicer and a 
    work around has been added to the vignette (reported by Chanhee Yi 
    and Zhang Peng).

*************************************************************************
*                       Changes in version 1.2.3                        *
*************************************************************************

BUG FIX
    o fixed error when running a %dorng% loop on a fresh session, with no  
    parallel backend registered.  

CHANGES
    o improved vignette
    o added more unit tests
    o changed the name of the RNG attribute on result of %dorng% looops 
    from 'RNG' to 'rng'. It now contains the whole sequence of RNG seeds, 
    instead of only the first one.
    o RNGseq now accepts a list or a matrix describing the whole sequence 
    of seeds. See vignette for more details.
    o %dorng% loops can be seeded with a complete sequence of seeds passed 
    as a list, a matrix, or an object with attribute 'rng', e.g. the 
    results of %dorng% loops. See vignette for more details.
    
*************************************************************************
*                       Changes in version 1.2.2                        *
*************************************************************************

BUG FIX
    o separate %dorng% loops were using the same seed.

NEW FEATURES
    o add unit tests
    o first seed is set as an attribute of the loop's result

CHANGES
    o function doRNGseed now returns the seed to use for the first 
    iteration.
    o RNGseq now change the current RNG state if called with no seed 
    specific.  
    
DEFUNCT
    o removed function CMRGseed

*************************************************************************
*                       Changes in version 1.2                          *
*************************************************************************

BUG FIX
    o An error was thrown if using %dorng% loops before using any random
    generator. Thanks to Eric Lehmann for reporting this.

CHANGES
    o add vignette
    o use package doParallel in examples

*************************************************************************
*                       Changes in version 1.1                          *
*************************************************************************

CHANGES
    o use R core RNG "L'Ecuyer-CMRG" and the parallel package, 
    instead of the implementation provided by the rstream package.



\end{verbatim}
}


\section*{Cleanup}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{flushleft}
\ttfamily\noindent
\hlfunctioncall{stopCluster}\hlkeyword{(}\hlsymbol{cl}\hlkeyword{)}\mbox{}
\normalfont
\end{flushleft}
\end{kframe}
\end{knitrout}


\section*{Session information}
\addcontentsline{toc}{section}{Session information}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
R version 2.15.0 (2012-03-30)
Platform: i686-pc-linux-gnu (32-bit)

locale:
 [1] LC_CTYPE=en_ZA.UTF-8       LC_NUMERIC=C               LC_TIME=en_ZA.UTF-8       
 [4] LC_COLLATE=en_ZA.UTF-8     LC_MONETARY=en_ZA.UTF-8    LC_MESSAGES=en_ZA.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C              
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_ZA.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] methods   parallel  stats     graphics  grDevices utils     datasets  base     

other attached packages:
[1] doRNG_1.4.4      pkgmaker_0.6.5   codetools_0.2-8  stringr_0.6      digest_0.5.2    
[6] doParallel_1.0.1 iterators_1.0.6  foreach_1.4.0    knitr_0.6.1     

loaded via a namespace (and not attached):
[1] compiler_2.15.0 evaluate_0.4.2  formatR_0.4     highlight_0.3.1 parser_0.0-14  
[6] plyr_1.7.1      Rcpp_0.9.10     tools_2.15.0    xtable_1.7-0   
\end{verbatim}
\end{kframe}
\end{knitrout}


\printbibliography[heading=bibintoc]

\end{document}
